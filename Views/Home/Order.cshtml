@{ Layout = null; }
<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>下單頁</title>
    <script src="~/Scripts/jquery-3.7.0.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
    <script src="~/signalr/hubs"></script>
    <style>
        body {
            font-family: system-ui,"Noto Sans TC",sans-serif;
            margin: 2rem
        }

        label {
            display: block;
            margin: .5rem 0 .25rem
        }

        input, textarea {
            width: 24rem;
            padding: .5rem
        }
    </style>
</head>
<body>
    <h1>下單頁</h1>
    <label>商店 Id</label><input id="shop" value="aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa">
    <label>餐點名稱</label><input id="name" value="拿鐵">
    <label>數量</label><input id="qty" type="number" value="1" min="1">
    <label>價格</label><input id="price" type="number" value="80" min="0" step="1">
    <label>備註</label><textarea id="notes" rows="3"></textarea>
    <button id="send">送出訂單</button>
<pre id="log"></pre>
    <script>
  var hub = $.connection.ordersHub;
  hub.client.orderChanged = function(p){ $('#log').append('[orderChanged] '+JSON.stringify(p)+'\n'); };
  $.connection.hub.start().done(function(){
    $('#log').text('已連線\n');
    $('#send').click(function(){
      var dto = { shopId: $('#shop').val(), notes: $('#notes').val(), items: [{ name: $('#name').val(), qty: +$('#qty').val(), price: +$('#price').val() }] };
      hub.server.createOrder(dto);
      $('#log').append('已送出：'+JSON.stringify(dto)+'\n');
    });
  });
    </script>
</body>
</html>
